# GEMINI.md: Project Context for ShipAny Template One & Alpha-Arena-Lite

This document provides essential context for interacting with the `shipany-template-one` codebase. It outlines the project's architecture, key technologies, and operational procedures.

## Project Overview

This project is a hybrid repository containing a **Next.js SaaS platform** ("ShipAny Template One") and a **Python-based Trading Engine** ("Alpha-Arena-Lite").

### 1. SaaS Platform (Frontend & API)
Built on "ShipAny Template One", designed to accelerate full-stack AI application development.
- **Framework**: Next.js 15 with App Router
- **Language**: TypeScript
- **Styling**: Tailwind CSS with shadcn/ui components
- **Database**: PostgreSQL with Drizzle ORM
- **Authentication**: NextAuth.js (Google & GitHub)
- **Payments**: Stripe
- **AI**: `@ai-sdk` (OpenAI, DeepSeek, Replicate)
- **i18n**: `next-intl` (English & Chinese)
- **Docs**: `fumadocs-mdx`

### 2. Trading Engine (Backend/Data Science)
Located in `specs/demo/`, this Python engine handles backtesting and simulated trading on Chinese A-shares using LLMs.
- **Core**: Python 3.x
- **Key Libs**: `pandas`, `numpy`, `openai`, `tinyshare` (for data), `plotly`
- **Function**: Executes strategies, logs trades to CSV, and generates visualization data.

## Key Files & Directories

### Root & Configuration
- `package.json`: Node.js dependencies and scripts.
- `requirements.txt`: Python dependencies for the trading engine.
- `next.config.mjs`: Next.js config.
- `tsconfig.json`: TypeScript config (Aliases: `@/*` -> `./src/*`).
- `.env`: Environment variables (see `.env.example`).

### Next.js App (`src/`)
- `src/app/[locale]/`: Main App Router routes.
- `src/db/schema.ts`: Drizzle ORM database schema.
- `src/auth/config.ts`: NextAuth.js configuration.
- `src/services/`: Business logic layer.
- `src/components/`: UI components (shadcn/ui).
- `src/i18n/`: Internationalization files.

### Python Engine (`specs/demo/`)
- `specs/demo/backtest.py`: Main historical backtesting script.
- `specs/demo/livetrade.py`: Simulated live trading script.
- `specs/demo/trade_decision_simple_AI.py`: LLM decision logic.
- `specs/demo/simple_portfolio.py`: Portfolio management (A-share rules).
- `specs/demo/visualization.py`: K-line charting.

## Building and Running

### SaaS Platform (Node.js)

1.  **Install Dependencies**:
    ```bash
    pnpm install
    ```
2.  **Setup Environment**:
    Copy `.env.example` to `.env` and fill in secrets (DB, Auth, Stripe, etc.).
3.  **Database Setup**:
    ```bash
    pnpm db:generate  # Generate migrations
    pnpm db:migrate   # Apply migrations
    ```
4.  **Run Development Server**:
    ```bash
    pnpm dev
    ```
    Access at `http://localhost:3000`.

### Trading Engine (Python)

1.  **Install Dependencies**:
    ```bash
    pip install -r requirements.txt
    ```
2.  **Setup Environment**:
    Ensure `.env` contains `TINYSHARE_TOKEN` and `DEEPSEEK_API_KEY` (or valid OpenAI-compatible key).
3.  **Run Backtest**:
    ```bash
    # Example: Backtest symbol 600519 for year 2024
    python specs/demo/backtest.py --symbol 600519 --start 20240101 --end 20241231
    ```
    **Output**: Results are saved to `backtest/<symbol>/` (e.g., `trades_*.csv`, `llm_returns_*.ndjson`).

## Development Conventions

- **Code Style (JS/TS)**: ESLint + Prettier. Run `pnpm lint`.
- **Path Aliases**: Use `@/` for imports from `src/` (e.g., `import { db } from "@/db"`).
- **i18n**: Add user-facing text to `src/i18n/messages/`.
- **Database**: Use `drizzle-kit` for schema changes. Avoid manual SQL if possible.

## Integration Goals (Frontend <-> Python)

The ultimate goal is to visualize the Python engine's results in the Next.js frontend.

1.  **Data Ingestion**: The Next.js app needs to read the CSV files generated by `specs/demo/backtest.py` (located in `backtest/`).
2.  **API Layer**: Create endpoints (e.g., `/api/account-totals`) to aggregate and serve this data.
3.  **Visualization**: Display performance metrics (Total Asset curves, Win Rates) using Recharts or Plotly.js components in the web UI.
